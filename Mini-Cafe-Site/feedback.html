<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini Project Part - 10 | Feedback Form with JS Validation </title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-color: #8B4513;
      --secondary-color: #A0522D;
      --light-color: #F5F5DC;
      --dark-color: #36221D;
      --box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background-color: var(--light-color);
      color: var(--dark-color);
      margin: 0;
      padding: 0;
      line-height: 1.6;
      text-align: center;
    }

    header {
      background-color: var(--dark-color);
      color: var(--light-color);
      padding: 1.5rem 0;
      box-shadow: var(--box-shadow);
    text-align: center;
    }

    header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      margin: 0;
       text-align: center;
    }

    header p {
      font-size: 1.1rem;
      margin-top: 0.5rem;
       text-align: center;
    }

    .container {
      max-width: 800px;
      margin: 2rem auto;
      background-color: #fff;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: var(--box-shadow);
      text-align: center;
    }

    h2 {
      font-family: 'Playfair Display', serif;
      color: var(--primary-color);
      font-size: 2rem;
      margin-bottom: 1rem;
      text-align: center;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      
    }

    label {
      font-weight: bold;
      color: var(--dark-color);
    }

    input, textarea, select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
      color: var(--dark-color);
      background-color: #f9f9f9;
      transition: border-color 0.3s ease-in-out;
    }

    input:focus, textarea:focus, select:focus {
      border-color: var(--primary-color);
      outline: none;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    button {
      background-color: var(--primary-color);
      color: var(--light-color);
      border: none;
      padding: 1rem;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background-color 0.3s ease-in-out;
    }

    button:hover {
      background-color: var(--secondary-color);
    }

    .btn-small {
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      margin-left: 0.5rem;
    }

    #message {
      margin-top: 1rem;
      font-weight: bold;
      text-align: center;
    }

    .error {
      color: #c62828;
    }

    .success {
      color: #2e7d32;
    }

    #feedbackList, #reservationList {
      margin-top: 2rem;
    }

    .entry {
      background-color: var(--light-color);
      border-left: 5px solid var(--secondary-color);
      padding: 1rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      box-shadow: var(--box-shadow);
      position: relative;
    }

    .entry strong {
      color: var(--primary-color);
      font-size: 1.1rem;
    }

    .entry small {
      color: var(--secondary-color);
    }

    .timestamp {
      font-size: 0.9rem;
      color: #555;
      margin-top: 0.5rem;
      display: block;
    }

    .entry-actions {
      position: absolute;
      top: 10px;
      right: 10px;
    }

    .entry-actions button {
      margin-left: 0.3rem;
    }

    @media (max-width: 768px) {
      .container {
        margin: 1rem;
        padding: 1.5rem;
      }
      h2 {
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>☕ Café de Palacio</h1>
    <p>Your thoughts make us better every day</p>
  </header>

  <div class="container">
    <!-- Feedback Form -->
    <h2>Share Your Feedback</h2>
    <form id="feedbackForm">
      <label for="fbName">Name:</label>
      <input type="text" id="fbName" placeholder="Your name" required>

      <label for="fbEmail">Email:</label>
      <input type="email" id="fbEmail" placeholder="you@example.com" required>

      <label for="fbMessage">Feedback Message:</label>
      <textarea id="fbMessage" placeholder="Write your thoughts..." required></textarea>

      <button type="submit" id="fbSubmitBtn">Submit Feedback</button>
      <button type="button" id="fbClearBtn" class="btn-small">Clear All Feedback</button>
    </form>

    <div id="fbMessage"></div>

    <section id="feedbackList">
      <h3>Previous Feedback</h3>
      <div id="fbContainer"></div>
    </section>

    <hr style="margin:2rem 0; border-color: var(--secondary-color);">

    <!-- Reservation Form -->
    <h2>Make a Reservation</h2>
    <form id="reservationForm">
      <label for="resName">Name:</label>
      <input type="text" id="resName" placeholder="Your name" required>

      <label for="resEmail">Email:</label>
      <input type="email" id="resEmail" placeholder="you@example.com" required>

      <label for="resPhone">Phone Number:</label>
      <input type="tel" id="resPhone" placeholder="123-456-7890" required>

      <label for="resDate">Date:</label>
      <input type="date" id="resDate" required>

      <label for="resTime">Time:</label>
      <input type="time" id="resTime" required>

      <label for="resGuests">Number of Guests:</label>
      <input type="number" id="resGuests" min="1" max="20" required>

      <button type="submit" id="resSubmitBtn">Submit Reservation</button>
      <button type="button" id="resClearBtn" class="btn-small">Clear All Reservations</button>
    </form>

    <div id="resMessage"></div>

    <section id="reservationList">
      <h3>Previous Reservations</h3>
      <div id="resContainer"></div>
    </section>
  </div>

  <script>
    /* ================= COMMON FUNCTIONS ================= */
    function validateEmail(email) {
      return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);
    }

    function showMessage(div, text, type) {
      div.textContent = text;
      div.className = type;
    }

    /* ================= FEEDBACK SECTION ================= */
    const fbForm = document.getElementById('feedbackForm');
    const fbMessageDiv = document.getElementById('fbMessage');
    const fbContainer = document.getElementById('fbContainer');
    const fbClearBtn = document.getElementById('fbClearBtn');
    const fbSubmitBtn = document.getElementById('fbSubmitBtn');

    let feedbacks = JSON.parse(localStorage.getItem('feedbacks')) || [];
    let fbEditIndex = null;

    displayFeedbacks();

    fbForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('fbName').value.trim();
      const email = document.getElementById('fbEmail').value.trim();
      const msg = document.getElementById('fbMessage').value.trim();

      if (!name || !email || !msg) { showMessage(fbMessageDiv, 'All fields are required.', 'error'); return; }
      if (!validateEmail(email)) { showMessage(fbMessageDiv, 'Enter a valid email.', 'error'); return; }

      const submittedAt = new Date().toLocaleString();
      const feedback = { name, email, msg, submittedAt };

      if (fbEditIndex !== null) {
        feedbacks[fbEditIndex] = feedback;
        fbEditIndex = null;
        fbSubmitBtn.textContent = "Submit Feedback";
        showMessage(fbMessageDiv, 'Feedback updated!', 'success');
      } else {
        feedbacks.push(feedback);
        showMessage(fbMessageDiv, 'Thank you for your feedback!', 'success');
      }

      localStorage.setItem('feedbacks', JSON.stringify(feedbacks));
      displayFeedbacks();
      fbForm.reset();
    });

    fbClearBtn.addEventListener('click', () => {
      if (confirm('Clear all feedback?')) {
        feedbacks = [];
        localStorage.removeItem('feedbacks');
        displayFeedbacks();
        showMessage(fbMessageDiv, 'All feedback cleared.', 'success');
      }
    });

    function displayFeedbacks() {
      fbContainer.innerHTML = '';
      if (feedbacks.length === 0) { fbContainer.innerHTML = '<p><em>No feedback yet.</em></p>'; return; }

      feedbacks.slice().reverse().forEach((f, idx) => {
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `
          <strong>${f.name}</strong> <small>(${f.email})</small>
          <p>${f.msg}</p>
          <span class="timestamp">Submitted at: ${f.submittedAt}</span>
          <div class="entry-actions">
            <button class="editBtn btn-small">Edit</button>
            <button class="deleteBtn btn-small">Delete</button>
          </div>
        `;
        div.querySelector('.editBtn').addEventListener('click', () => {
          fbEditIndex = feedbacks.length - 1 - idx;
          document.getElementById('fbName').value = f.name;
          document.getElementById('fbEmail').value = f.email;
          document.getElementById('fbMessage').value = f.msg;
          fbSubmitBtn.textContent = "Update Feedback";
        });
        div.querySelector('.deleteBtn').addEventListener('click', () => {
          if (confirm('Delete this feedback?')) {
            feedbacks.splice(feedbacks.length - 1 - idx, 1);
            localStorage.setItem('feedbacks', JSON.stringify(feedbacks));
            displayFeedbacks();
            showMessage(fbMessageDiv, 'Feedback deleted.', 'success');
          }
        });
        fbContainer.appendChild(div);
      });
    }

    /* ================= RESERVATION SECTION ================= */
    const resForm = document.getElementById('reservationForm');
    const resMessageDiv = document.getElementById('resMessage');
    const resContainer = document.getElementById('resContainer');
    const resClearBtn = document.getElementById('resClearBtn');
    const resSubmitBtn = document.getElementById('resSubmitBtn');

    let reservations = JSON.parse(localStorage.getItem('reservations')) || [];
    let resEditIndex = null;

    displayReservations();

    resForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('resName').value.trim();
      const email = document.getElementById('resEmail').value.trim();
      const phone = document.getElementById('resPhone').value.trim();
      const date = document.getElementById('resDate').value;
      const time = document.getElementById('resTime').value;
      const guests = document.getElementById('resGuests').value;

      if (!name || !email || !phone || !date || !time || !guests) { showMessage(resMessageDiv, 'All fields are required.', 'error'); return; }
      if (!validateEmail(email)) { showMessage(resMessageDiv, 'Enter a valid email.', 'error'); return; }

      const submittedAt = new Date().toLocaleString();
      const reservation = { name, email, phone, date, time, guests, submittedAt };

      if (resEditIndex !== null) {
        reservations[resEditIndex] = reservation;
        resEditIndex = null;
        resSubmitBtn.textContent = "Submit Reservation";
        showMessage(resMessageDiv, 'Reservation updated!', 'success');
      } else {
        reservations.push(reservation);
        showMessage(resMessageDiv, 'Reservation submitted!', 'success');
      }

      localStorage.setItem('reservations', JSON.stringify(reservations));
      displayReservations();
      resForm.reset();
    });

    resClearBtn.addEventListener('click', () => {
      if (confirm('Clear all reservations?')) {
        reservations = [];
        localStorage.removeItem('reservations');
        displayReservations();
        showMessage(resMessageDiv, 'All reservations cleared.', 'success');
      }
    });

    function displayReservations() {
      resContainer.innerHTML = '';
      if (reservations.length === 0) { resContainer.innerHTML = '<p><em>No reservations yet.</em></p>'; return; }

      reservations.slice().reverse().forEach((r, idx) => {
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `
          <strong>${r.name}</strong> <small>(${r.email}, ${r.phone})</small>
          <p>Date: ${r.date} | Time: ${r.time} | Guests: ${r.guests}</p>
          <span class="timestamp">Submitted at: ${r.submittedAt}</span>
          <div class="entry-actions">
            <button class="editBtn btn-small">Edit</button>
            <button class="deleteBtn btn-small">Delete</button>
          </div>
        `;
        div.querySelector('.editBtn').addEventListener('click', () => {
          resEditIndex = reservations.length - 1 - idx;
          document.getElementById('resName').value = r.name;
          document.getElementById('resEmail').value = r.email;
          document.getElementById('resPhone').value = r.phone;
          document.getElementById('resDate').value = r.date;
          document.getElementById('resTime').value = r.time;
          document.getElementById('resGuests').value = r.guests;
          resSubmitBtn.textContent = "Update Reservation";
        });
        div.querySelector('.deleteBtn').addEventListener('click', () => {
          if (confirm('Delete this reservation?')) {
            reservations.splice(reservations.length - 1 - idx, 1);
            localStorage.setItem('reservations', JSON.stringify(reservations));
            displayReservations();
            showMessage(resMessageDiv, 'Reservation deleted.', 'success');
          }
        });
        resContainer.appendChild(div);
      });
    }
  </script>
</body>
</html>
